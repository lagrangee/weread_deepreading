# å¾®ä¿¡è¯»ä¹¦æ·±åº¦é˜…è¯»åŠ©æ‰‹ (WeRead Deep Reading Assistant)

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Chrome Extension](https://img.shields.io/badge/Chrome-Extension-blue.svg)](https://chrome.google.com/webstore)
[![Version](https://img.shields.io/badge/version-1.1.2-green.svg)](https://github.com/lagrangee/weread_deepreading)

## ğŸ“– é¡¹ç›®ä»‹ç»

å¾®ä¿¡è¯»ä¹¦æ·±åº¦é˜…è¯»åŠ©æ‰‹æ˜¯ä¸€ä¸ªChromeæµè§ˆå™¨æ‰©å±•ï¼Œé€šè¿‡é›†æˆå¤šä¸ªAIå¤§æ¨¡å‹ï¼Œä¸ºå¾®ä¿¡è¯»ä¹¦ç”¨æˆ·æä¾›æ™ºèƒ½é˜…è¯»è¾…åŠ©åŠŸèƒ½ã€‚æ”¯æŒæ–‡æœ¬è§£é‡Šã€å†…å®¹æ¶ˆåŒ–ã€å¤šè§’åº¦åˆ†æç­‰åŠŸèƒ½ï¼Œè®©é˜…è¯»æ›´åŠ æ·±å…¥å’Œé«˜æ•ˆã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ¯ ä¸‰å¤§AIåŠ©æ‰‹åŠŸèƒ½

1. **ğŸ’¡ è§£é‡Šä¸€ä¸‹ (Explain)**
   - å¯¹é€‰ä¸­æ–‡æœ¬è¿›è¡Œæœ¯è¯­è§£é‡Šã€èƒŒæ™¯è¡¥å……
   - å¿«æ·é”®ï¼š`E`
   - é€‚ç”¨åœºæ™¯ï¼šä¸“ä¸šæœ¯è¯­ã€äººåã€æ¦‚å¿µç­‰

2. **ğŸ“– æ¶ˆåŒ–ä¸€ä¸‹ (Digest)**  
   - å°†å¤æ‚å†…å®¹è½¬åŒ–ä¸ºæ˜“ç†è§£çš„è§£è¯»
   - åŒ…å«ï¼šæ ¸å¿ƒè§‚ç‚¹ã€æ€æƒ³æµæ´¾ã€å†å²æ¼”è¿›
   - å¿«æ·é”®ï¼š`X`
   - é€‚ç”¨åœºæ™¯ï¼šé•¿æ®µè½ã€å¤æ‚ç†è®º

3. **ğŸ‘‚ å…¼å¬ä¸€ä¸‹ (Analyze)**
   - æä¾›å¤šè§’åº¦åˆ†æå’Œä¸åŒè§‚ç‚¹
   - åŒ…å«ï¼šæ”¯æŒ/åå¯¹è®ºæ®ã€å­¦è€…è§‚ç‚¹ã€æ‰©å±•é˜…è¯»
   - å¿«æ·é”®ï¼š`M`
   - é€‚ç”¨åœºæ™¯ï¼šäº‰è®®æ€§å†…å®¹ã€è§‚ç‚¹åˆ†æ

### ğŸ”§ æŠ€æœ¯ç‰¹æ€§

- **å¤šAIæœåŠ¡å•†æ”¯æŒ**ï¼šæ–‡å¿ƒä¸€è¨€ã€é€šä¹‰åƒé—®ã€è±†åŒ…ã€DeepSeek
- **æ™ºèƒ½é¢æ¿ç³»ç»Ÿ**ï¼šæµ®åŠ¨/å†…åµŒæ¨¡å¼åˆ‡æ¢ï¼Œæ”¯æŒæ‹–æ‹½å’Œè°ƒæ•´å¤§å°
- **ä¼šè¯å¼äº¤äº’**ï¼šæ”¯æŒè¿ç»­å¯¹è¯ï¼Œä¿æŒä¸Šä¸‹æ–‡
- **Markdownæ¸²æŸ“**ï¼šå¯Œæ–‡æœ¬æ˜¾ç¤ºï¼Œæ”¯æŒä»£ç é«˜äº®
- **æœ¬åœ°å­˜å‚¨**ï¼šAPI Keyå®‰å…¨å­˜å‚¨ï¼Œè®¾ç½®è‡ªåŠ¨åŒæ­¥
- **å¿«æ·é”®æ”¯æŒ**ï¼šå…¨å±€å¿«æ·é”®ï¼Œæå‡ä½¿ç”¨æ•ˆç‡

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

### ğŸ“ ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ shared/                 # å…±äº«æ¨¡å—
â”‚   â”œâ”€â”€ config.js          # å…¨å±€é…ç½®
â”‚   â”œâ”€â”€ message-types.js   # æ¶ˆæ¯ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ bridge-service.js  # é€šä¿¡æ¡¥æ¥æœåŠ¡
â”‚   â””â”€â”€ settings-service.js # è®¾ç½®ç®¡ç†æœåŠ¡
â”œâ”€â”€ background/             # åå°è„šæœ¬
â”‚   â”œâ”€â”€ background.js      # ä¸»å…¥å£
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ chat-service.js # AIèŠå¤©æœåŠ¡
â”œâ”€â”€ content/               # å†…å®¹è„šæœ¬
â”‚   â”œâ”€â”€ content.js        # ä¸»å…¥å£
â”‚   â”œâ”€â”€ components/       # UIç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ assistant-panel.js # ä¸»é¢æ¿ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ chat/         # èŠå¤©ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ help-modal/   # å¸®åŠ©æ¨¡æ€æ¡†
â”‚   â”‚   â””â”€â”€ interactive/  # äº¤äº’ç»„ä»¶(æ‹–æ‹½ã€è°ƒæ•´å¤§å°)
â”‚   â”œâ”€â”€ services/         # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ chat-service.js    # èŠå¤©æœåŠ¡
â”‚   â”‚   â””â”€â”€ content-bridge.js  # å†…å®¹æ¡¥æ¥
â”‚   â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ dom-utils.js  # DOMæ“ä½œå·¥å…·
â”‚       â””â”€â”€ event-utils.js # äº‹ä»¶å¤„ç†å·¥å…·
â”œâ”€â”€ popup/                # å¼¹å‡ºçª—å£
â”‚   â”œâ”€â”€ popup.html       # è®¾ç½®ç•Œé¢
â”‚   â”œâ”€â”€ popup.css        # æ ·å¼æ–‡ä»¶
â”‚   â””â”€â”€ popup.js         # è®¾ç½®é€»è¾‘
â””â”€â”€ lib/                 # ç¬¬ä¸‰æ–¹åº“
    â””â”€â”€ marked.min.js    # Markdownè§£æå™¨
```

### ğŸ”„ æ¶æ„è®¾è®¡

```mermaid
graph TB
    A[Content Script] --> B[BridgeService]
    B --> C[Background Script]
    C --> D[AI Services]
    
    A --> E[AssistantPanel]
    E --> F[ChatComponent]
    E --> G[InteractiveComponents]
    
    H[Popup] --> B
    B --> I[SettingsService]
    I --> J[Chrome Storage]
    
    C --> K[MessageRouter]
    K --> L[ChatService]
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ“‹ ç¯å¢ƒè¦æ±‚

- **Chromeæµè§ˆå™¨** >= 88
- **Node.js** >= 14.0.0
- **npm** >= 6.0.0

### ğŸ› ï¸ å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/lagrangee/weread_deepreading.git
cd weread_deepreading
```

2. **å®‰è£…ä¾èµ–**
```bash
npm install
```

3. **å¼€å‘æ¨¡å¼æ„å»º**
```bash
npm start
# æˆ–è€…
npm run dev
```

4. **ç”Ÿäº§æ¨¡å¼æ„å»º**
```bash
npm run build
```

5. **åŠ è½½åˆ°Chrome**
   - æ‰“å¼€ `chrome://extensions/`
   - å¼€å¯"å¼€å‘è€…æ¨¡å¼"
   - ç‚¹å‡»"åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº"
   - é€‰æ‹© `dist` ç›®å½•

### âš™ï¸ é…ç½®API Key

1. ç‚¹å‡»æ‰©å±•å›¾æ ‡æ‰“å¼€è®¾ç½®é¢æ¿
2. é€‰æ‹©AIæœåŠ¡å•†ï¼ˆæ–‡å¿ƒä¸€è¨€/é€šä¹‰åƒé—®/è±†åŒ…/DeepSeekï¼‰
3. è¾“å…¥å¯¹åº”çš„API Key
4. ç‚¹å‡»"æµ‹è¯•"éªŒè¯è¿æ¥
5. ä¿å­˜è®¾ç½®

## ğŸ“– ä½¿ç”¨æŒ‡å—

### ğŸ® åŸºæœ¬æ“ä½œ

1. **é€‰æ‹©æ–‡æœ¬**ï¼šåœ¨å¾®ä¿¡è¯»ä¹¦é¡µé¢é€‰ä¸­è¦åˆ†æçš„æ–‡æœ¬
2. **é€‰æ‹©åŠŸèƒ½**ï¼šç‚¹å‡»å¯¹åº”çš„AIæŒ‰é’®æˆ–ä½¿ç”¨å¿«æ·é”®
   - `E` - è§£é‡Šä¸€ä¸‹
   - `X` - æ¶ˆåŒ–ä¸€ä¸‹  
   - `M` - å…¼å¬ä¸€ä¸‹
3. **æŸ¥çœ‹ç»“æœ**ï¼šAIåˆ†æç»“æœä¼šæ˜¾ç¤ºåœ¨åŠ©æ‰‹é¢æ¿ä¸­
4. **ç»§ç»­å¯¹è¯**ï¼šå¯ä»¥åœ¨è¾“å…¥æ¡†ä¸­ç»§ç»­æé—®

### âŒ¨ï¸ å¿«æ·é”®

| å¿«æ·é”® | åŠŸèƒ½ | è¯´æ˜ |
|--------|------|------|
| `E` | è§£é‡Šä¸€ä¸‹ | è§£é‡Šé€‰ä¸­æ–‡æœ¬ |
| `X` | æ¶ˆåŒ–ä¸€ä¸‹ | æ¶ˆåŒ–é€‰ä¸­å†…å®¹ |
| `M` | å…¼å¬ä¸€ä¸‹ | å¤šè§’åº¦åˆ†æ |
| `Esc` | å…³é—­é¢æ¿ | éšè—åŠ©æ‰‹é¢æ¿ |
| `?` | å¸®åŠ©ä¿¡æ¯ | æ˜¾ç¤ºå¸®åŠ©æ¨¡æ€æ¡† |

### ğŸ¨ ç•Œé¢æ¨¡å¼

- **æµ®åŠ¨æ¨¡å¼**ï¼šé¢æ¿æµ®åŠ¨åœ¨é¡µé¢ä¸Šæ–¹ï¼Œå¯è‡ªç”±æ‹–æ‹½å’Œè°ƒæ•´å¤§å°
- **å†…åµŒæ¨¡å¼**ï¼šé¢æ¿åµŒå…¥é¡µé¢å³ä¾§ï¼Œä¸é¡µé¢å†…å®¹å¹¶æ’æ˜¾ç¤º

## ğŸ”§ å¼€å‘æŒ‡å—

### ğŸ“ å¼€å‘è§„èŒƒ

- **ä»£ç é£æ ¼**ï¼šéµå¾ªESLintå’ŒPrettieré…ç½®
- **æ³¨é‡Šè§„èŒƒ**ï¼šä½¿ç”¨JSDocæ ¼å¼ï¼Œä¸­æ–‡æ³¨é‡Š
- **å‘½åè§„èŒƒ**ï¼š
  - ç±»åï¼šPascalCase
  - æ–¹æ³•åï¼šcamelCase
  - å¸¸é‡ï¼šUPPER_SNAKE_CASE
  - ç§æœ‰å­—æ®µï¼šä»¥`#`å¼€å¤´

### ğŸ—ï¸ æ¶æ„åŸåˆ™

1. **æ¨¡å—åŒ–è®¾è®¡**ï¼šæŒ‰åŠŸèƒ½åŸŸåˆ’åˆ†æ¨¡å—
2. **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªç±»/æ¨¡å—åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½
3. **ä¾èµ–æ³¨å…¥**ï¼šé¿å…ç¡¬ç¼–ç ä¾èµ–
4. **é”™è¯¯å¤„ç†**ï¼šç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
5. **æ€§èƒ½ä¼˜åŒ–**ï¼šæ‡’åŠ è½½ã€ç¼“å­˜ã€é˜²æŠ–ç­‰

### ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæµ‹è¯•
npm test

# ç›‘å¬æ¨¡å¼
npm run test:watch

# ä»£ç æ£€æŸ¥
npm run lint

# è‡ªåŠ¨ä¿®å¤
npm run lint:fix
```

### ğŸ› è°ƒè¯•

1. **Background Scriptè°ƒè¯•**
   - è®¿é—® `chrome://extensions/`
   - ç‚¹å‡»æ‰©å±•çš„"èƒŒæ™¯é¡µ"é“¾æ¥

2. **Content Scriptè°ƒè¯•**
   - åœ¨å¾®ä¿¡è¯»ä¹¦é¡µé¢æŒ‰F12
   - æŸ¥çœ‹Consoleé¢æ¿çš„æ—¥å¿—

3. **Popupè°ƒè¯•**
   - å³é”®æ‰©å±•å›¾æ ‡
   - é€‰æ‹©"æ£€æŸ¥å¼¹å‡ºå†…å®¹"

## ğŸ“š APIæ–‡æ¡£

### ğŸ”Œ BridgeService

ç»Ÿä¸€çš„è·¨ç¯å¢ƒé€šä¿¡æœåŠ¡ï¼š

```javascript
// å‘é€æ¶ˆæ¯
await bridge.sendMessage(type, data, options);

// æ³¨å†Œå¤„ç†å™¨
bridge.on(type, handler);

// å¹¿æ’­æ¶ˆæ¯
await bridge.broadcast(type, data);
```

### ğŸ—ƒï¸ SettingsService

è®¾ç½®ç®¡ç†æœåŠ¡ï¼š

```javascript
// ä¿å­˜è®¾ç½®
await settingsService.saveProvider(provider);
await settingsService.saveAPIKeys(apiKeys);

// åŠ è½½è®¾ç½®
const provider = await settingsService.loadProvider();
const apiKeys = await settingsService.loadAPIKeys();
```

### ğŸ¤– ChatService

AIèŠå¤©æœåŠ¡ï¼š

```javascript
// å‘é€AIè¯·æ±‚
const response = await chatService.sendMessage({
  text: 'è¦åˆ†æçš„æ–‡æœ¬',
  type: 'explain', // 'explain' | 'digest' | 'analyze'
  provider: 'doubao'
});
```

## ğŸ”’ å®‰å…¨æ€§

### ğŸ›¡ï¸ æ•°æ®å®‰å…¨

- **API KeyåŠ å¯†å­˜å‚¨**ï¼šä½¿ç”¨Chrome Storage APIå®‰å…¨å­˜å‚¨
- **æœ¬åœ°æ•°æ®å¤„ç†**ï¼šç”¨æˆ·æ•°æ®ä¸ä¸Šä¼ åˆ°æœåŠ¡å™¨
- **æƒé™æœ€å°åŒ–**ï¼šåªè¯·æ±‚å¿…è¦çš„Chromeæƒé™

### ğŸ“‹ æƒé™è¯´æ˜

```json
{
  "permissions": [
    "storage",           // å­˜å‚¨ç”¨æˆ·è®¾ç½®
    "activeTab"          // è®¿é—®å½“å‰æ ‡ç­¾é¡µ
  ],
  "host_permissions": [
    "https://weread.qq.com/*"  // å¾®ä¿¡è¯»ä¹¦åŸŸå
  ]
}
```

## ğŸš€ éƒ¨ç½²å‘å¸ƒ

### ğŸ“¦ æ‰“åŒ…

```bash
# ç”Ÿäº§æ„å»º
npm run build

# æ‰“åŒ…ä¸ºzipæ–‡ä»¶
npm run package
```

### ğŸª Chrome Web Storeå‘å¸ƒ

1. è®¿é—® [Chromeå¼€å‘è€…æ§åˆ¶å°](https://chrome.google.com/webstore/developer/dashboard)
2. ä¸Šä¼ æ‰“åŒ…åçš„zipæ–‡ä»¶
3. å¡«å†™æ‰©å±•ä¿¡æ¯å’Œæè¿°
4. æäº¤å®¡æ ¸

## ğŸ¤ è´¡çŒ®æŒ‡å—

### ğŸ”„ å¼€å‘æµç¨‹

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ï¼š`git checkout -b feature/amazing-feature`
3. æäº¤æ›´æ”¹ï¼š`git commit -m 'Add amazing feature'`
4. æ¨é€åˆ†æ”¯ï¼š`git push origin feature/amazing-feature`
5. åˆ›å»ºPull Request

### ğŸ“‹ æäº¤è§„èŒƒ

```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: ä»£ç é‡æ„
test: æµ‹è¯•ç”¨ä¾‹
chore: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨
```

## ğŸ“ˆ ç‰ˆæœ¬å†å²

### v1.1.2 (2025-06-05)
- ğŸ› ä¿®å¤ inline æ¨¡å¼ä¸‹æ¯æ¬¡å¤åˆ¶éƒ½ä¼šè§¦å‘é¡µé¢åˆ·æ–°çš„bug

### v1.1.1 (2025-06-05)
- ğŸ“ ä¿®å¤ popup åˆå§‹çŠ¶æ€é”™è¯¯

### v1.1.0 (2025-06-04)
- âœ¨ æ–°å¢æµå¼å“åº”æ”¯æŒï¼ŒAIå›ç­”å®æ—¶æ˜¾ç¤º
- ğŸš€ ä¼˜åŒ–å“åº”é€Ÿåº¦ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
- ğŸ”§ æ”¹è¿›é”™è¯¯å¤„ç†æœºåˆ¶
- ğŸ¨ ç•Œé¢ç»†èŠ‚ä¼˜åŒ–å’ŒåŠ¨ç”»æ•ˆæœæå‡
- ğŸ“± å“åº”å¼è®¾è®¡æ”¹è¿›

### v1.0.0 (2025-05-29)
- âœ¨ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- ğŸ¯ ä¸‰å¤§AIåŠŸèƒ½ï¼šè§£é‡Šã€æ¶ˆåŒ–ã€å…¼å¬
- ğŸ”§ å¤šAIæœåŠ¡å•†æ”¯æŒ
- ğŸ¨ æ™ºèƒ½é¢æ¿ç³»ç»Ÿ
- âŒ¨ï¸ å¿«æ·é”®æ”¯æŒ

## ğŸ”® æœªæ¥è®¡åˆ’

- [ ] æ”¯æŒæ›´å¤šAIæœåŠ¡å•†
- [ ] ç”¨æˆ·è‡ªå®šä¹‰æç¤ºè¯
- [ ] é˜…è¯»ç¬”è®°ç®¡ç†
- [ ] å¤šè¯­è¨€æ”¯æŒ
- [ ] ç§»åŠ¨ç«¯é€‚é…

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) è®¸å¯è¯ã€‚

## ğŸ“ è”ç³»æ–¹å¼

- **ä½œè€…**ï¼šlagrangee@gmail.com
- **é¡¹ç›®åœ°å€**ï¼šhttps://github.com/lagrangee/weread_deepreading
- **é—®é¢˜åé¦ˆ**ï¼šhttps://github.com/lagrangee/weread_deepreading/issues

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š
- [marked](https://github.com/markedjs/marked) - Markdownè§£æå™¨
- [webpack](https://webpack.js.org/) - æ¨¡å—æ‰“åŒ…å·¥å…·
- [babel](https://babeljs.io/) - JavaScriptç¼–è¯‘å™¨

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ªStaræ”¯æŒä¸€ä¸‹ï¼
